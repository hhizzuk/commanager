<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Settings</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/main.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles/settings.css') }}">
</head>
<body>
    <div id="header"></div>
    {% include "components/header.html" %}
    <script src="{{ url_for('static', filename='js/profile-menu.js') }}"></script>
    
    <!-- Settings Page Content -->
    <div class="settings-container">
        <h1>Settings</h1>
        <!-- Add this to your existing settings.html -->
        <div class="settings-section">
            <h2>Account Information</h2>
            <div>
                <h3>Change Password</h3>
                <form id="passwordForm">
                    <label for="current_password">Current Password</label>
                    <input type="password" id="current_password" name="current_password" placeholder="Current password" required>
                    
                    <label for="new_password">New Password</label>
                    <input type="password" id="new_password" name="new_password" placeholder="New password" >

                    <label for="confirm_password">Confirm Password</label>
                    <input type="password" id="confirm_password" name="confirm_password" placeholder="Confirm password" required>
                    
                    <button type="submit" class="Button">Save Changes</button>
                </form>
                <div id="passwordMessage"></div>
            </div>
        </div>

        <script>
        document.getElementById('passwordForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            const form = e.target;
            const message = document.getElementById('passwordMessage');
            message.textContent = '';
            
            // Validate passwords match
            if (form.new_password.value !== form.confirm_password.value) {
                message.textContent = "New passwords don't match!";
                return;
            }

            try {
                const response = await fetch('/update_password', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        current_password: form.current_password.value,
                        new_password: form.new_password.value
                    })
                });

                const result = await response.json();
                
                if (response.ok) {
                    message.textContent = "Password updated successfully!";
                    form.reset();
                } else {
                    message.textContent = result.error || "Failed to update password";
                }
            } catch (err) {
                message.textContent = "Network error occurred";
                console.error(err);
            }
        });
</script>

        <!-- ... previous content ... -->

    <div class="settings-section danger-zone">
        <h2>Danger Zone</h2>
        <p>Deleting your account is irreversible. All data will be lost.</p>
        <button class="Button" onclick="navigateToDestroyAccount()">

            <script>
            function navigateToDestroyAccount() {
                window.location.href = "{{ url_for('destroy_account') }}";
            }
            </script>
        Delete Account
        </button>
    </div>
  
  <!-- ... rest of the page ... -->
  
    </div>
    </body>
</html>