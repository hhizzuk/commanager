<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/payment.css">
    <!-- PayPal SDK placeholder -->
    <script src="https://www.paypal.com/sdk/js?client-id=ATFxo_K5mJsIVmXH_nAz0BG0f44JXTBHWIdkaEv58ZxNoq40xIPkrnNkVWjIDOMkFwue6NL3fH15iujD"></script>
</head>
<body>
    <div class="payment-container">
        <h2>Payment Details</h2>
        
        <!-- Payment Options -->
        <div class="payment-options">
            <button class="payment-option active" data-target="credit-card">
                Credit Card
            </button>
            <button class="payment-option" data-target="paypal">
                PayPal
            </button>
        </div>

        <!-- Credit Card Form -->
        <div id="credit-card" class="payment-section active">
            <form id="payment-form">
                <div class="form-group">
                    <label for="card-name">Name on Card</label>
                    <input type="text" id="card-name" required>
                </div>

                <div class="form-group">
                    <label for="card-number">Card Number</label>
                    <input type="text" id="card-number" maxlength="19" placeholder="1234 5678 9012 3456" required>
                </div>

                <div class="form-row">
                    <div class="form-group half">
                        <label for="expiry">Expiry Date</label>
                        <input type="text" id="expiry" placeholder="MM/YY" maxlength="5" required>
                    </div>
                    <div class="form-group half">
                        <label for="cvv">CVV</label>
                        <input type="text" id="cvv" maxlength="4" required>
                    </div>
                </div>

                <div class="billing-address">
                    <h3>Billing Address</h3>
                    
                    <div class="form-group">
                        <label for="address">Street Address</label>
                        <input type="text" id="address" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group half">
                            <label for="city">City</label>
                            <input type="text" id="city" required>
                        </div>
                        <div class="form-group half">
                            <label for="state">State</label>
                            <input type="text" id="state" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group half">
                            <label for="zip">ZIP Code</label>
                            <input type="text" id="zip" required>
                        </div>
                        <div class="form-group half">
                            <label for="country">Country</label>
                            <select id="country" required>
                                <option value="US">United States</option>
                                <option value="CA">Canada</option>
                                <!-- Add more countries as needed -->
                            </select>
                        </div>
                    </div>
                </div>

                <button type="submit" class="submit-button">Pay Now</button>
            </form>
        </div>

        <!-- PayPal Section -->
        <div id="paypal" class="payment-section">
            <div class="paypal-container">
                <h3>Pay with PayPal</h3>
                <div id="paypal-button-container"></div> <!-- PayPal button appears here -->
            </div>
        </div>        
    </div>

    <script>
        // Payment option switching
        const paymentOptions = document.querySelectorAll('.payment-option');
        const paymentSections = document.querySelectorAll('.payment-section');

        paymentOptions.forEach(option => {
            option.addEventListener('click', () => {
                // Remove active class from all options and sections
                paymentOptions.forEach(opt => opt.classList.remove('active'));
                paymentSections.forEach(section => section.classList.remove('active'));

                // Add active class to clicked option and corresponding section
                option.classList.add('active');
                document.getElementById(option.dataset.target).classList.add('active');
            });
        });

        // Card number formatting
        document.getElementById('card-number').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
            let formattedValue = value.replace(/(.{4})/g, '$1 ').trim();
            e.target.value = formattedValue;
        });

        // Expiry date formatting
        document.getElementById('expiry').addEventListener('input', function(e) {
            let value = e.target.value.replace(/\s/g, '').replace(/[^0-9]/gi, '');
            if (value.length >= 2) {
                value = value.slice(0, 2) + '/' + value.slice(2);
            }
            e.target.value = value;
        });

        // Form submission
        document.getElementById('payment-form').addEventListener('submit', function(e) {
            e.preventDefault();
            // Here you would typically:
            // 1. Validate all inputs
            // 2. Send data to payment processor
            // 3. Handle response
            alert('Payment processing would happen here in a real implementation');
        });

        // PayPal button rendering (placeholder)
        // PayPal Button Integration
        // paypal.Buttons({
        //     createOrder: function(data, actions) {
        //         return actions.order.create({
        //             purchase_units: [{
        //                 amount: {
        //                     value: '10.00' // Replace with actual amount
        //                 }
        //             }]
        //         });
        //     },
        //     onApprove: function(data, actions) {
        //         return actions.order.capture().then(function(details) {
        //             alert('Payment successful! Thank you, ' + details.payer.name.given_name);
        //             console.log(details);
                    
        //             // Send payment details to backend
        //             fetch('/process_payment', {
        //                 method: 'POST',
        //                 headers: {
        //                     'Content-Type': 'application/json'
        //                 },
        //                 body: JSON.stringify(details)
        //             }).then(response => response.json())
        //             .then(data => console.log('Payment processed:', data))
        //             .catch(error => console.error('Error:', error));
        //         });
        //     }
        // }).render('#paypal-button-container');

        window.onload = function() {
        if (window.paypal) {
            paypal.Buttons({
                createOrder: function(data, actions) {
                    return actions.order.create({
                        purchase_units: [{
                            amount: { value: '10.00' }
                        }]
                    });
                },
                onApprove: function(data, actions) {
                    return actions.order.capture().then(function(details) {
                        alert('Payment successful! Thank you, ' + details.payer.name.given_name);
                    });
                }
            }).render('#paypal-button-container');
        } else {
            console.error("PayPal SDK failed to load.");
        }
    };

    </script>
</body>
</html>
